<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>红包管理平台</title>
    <style>
        ::-webkit-scrollbar {
            width: 0 !important;
        }
        ::-webkit-scrollbar {
            width: 0 !important;height: 0;
        }

        .c_iframe{
            width: 100%;
            height: 100%;
            border: 0;
            overflow: hidden;
        }

        .el-menu{
            border:0!important;
        }
    </style>

</head>
<body>

<script src="js/vue.js"></script>
<script src="element-ui/lib/index.js"></script>
<link rel="stylesheet" href="element-ui/lib/theme-chalk/index.css">

<script src="https://cdn.staticfile.org/axios/0.18.0/axios.min.js"></script>

<style>
    html,body{height: 100%;margin: 0}

    a{TEXT-DECORATION:none}
    /*.el-aside ::-webkit-scrollbar{*/
    /*    display: none;*/
    /*}*/

    #app2{
        float: left;
        background-color: #333333;
        width: 10%;
        height: 100%;
        /*text-align: center;*/
    }

    .left {
        float: left;
        height: 100%;
    }

    .right {
        float: right;
        width: 90%;
        height: 100%;
    }
</style>

<div id="app" class="right">

    <!--表格-->
    <!--看上去好像有两个被弃用了，实际上他们俩是取消滚轮的唯一功臣-->
    <iframe src="page/user.html"
            width="100%"
            height="auto"
            frameborder="0"
            scrolling="no"
            class="c_iframe">

    </iframe>

</div>

<div id="app2" class="left">
    <el-row class="tac">
        <el-aside width="auto" style="overflow: hidden">
            <!--            <el-col :span="12">-->
            <el-menu
                    :default-active=activeIndex
                    class="el-menu-vertical-demo"
                    @open="handleOpen"
                    @close="handleClose"
                    background-color="#333333"
                    text-color="#fff"
            >

                <el-menu-item index="1">
                    <i class="el-icon-s-custom"></i>
                    <span slot="title" onclick="gaiyixia('tb_brand_copy1')">人员管理</span>
                </el-menu-item>
                <el-menu-item index="2">
                    <i class="el-icon-menu"></i>
                    <span slot="title" onclick="gaiyixia('tb_brand_copy2')">学生表</span>
                </el-menu-item>
                <el-menu-item index="3">
                    <i class="el-icon-menu"></i>
                    <span slot="title">课程表</span>
                </el-menu-item>
                <el-menu-item index="4">
                    <i class="el-icon-menu"></i>
                    <span slot="title">教师表</span>
                </el-menu-item>
            </el-menu>
            <!--            </el-col>-->
        </el-aside>
    </el-row>

</div>

<script>
    var shiyixiashuzi = 'tb_brand';

    function gaiyixia(val){
        shiyixiashuzi = val;
        //无法在axios使用this，所以在axios外定义了一个
        var _this = this;
        // console.log("aabb"+_this.brand.tablename);
        //页面加载完后发送异步请求，获取数据
        axios({
            method:"post",
            url:"http://localhost:8081/brand-case/tableChange",
            data:shiyixiashuzi
        })
    }

    new Vue({
        el:"#app2",

        methods:{
            // tableChange(name){
            //     const _this = this;
            //     switch (name) {
            //         default :_this.brand.tablename = "tb_brand";Utils.$emit('demo');break;
            //         case 'tb_brand':_this.brand.tablename = "tb_brand";Utils.$emit('demo');break;
            //         case 'tb_brandsec':_this.brand.tablename = "tb_brandsec";Utils.$emit('demo');break;
            //     }
            // },

            // selectALL() {
            //     //无法在axios使用this，所以在axios外定义了一个
            //     var _this = this;
            //     num = 1;
            //     // console.log("aabb"+_this.brand.tablename);
            //     //页面加载完后发送异步请求，获取数据
            //     axios({
            //         method:"post",
            //         url:"http://localhost:8081/brand-case/selectByPageAndCondition?currentPage="+this.currentPage+"&pageSize="+this.pageSize,
            //         data:_this.brand
            //     }).then(resp =>{
            //         //设置表格数据
            //         _this.tableData = resp.data.rows; // {rows:[],totalCount:100}
            //         //设置总记录数
            //         _this.totalCount = resp.data.totalCount;
            //     })
            // },

            handleOpen(key, keyPath) {
                console.log(key, keyPath);
            },
            handleClose(key, keyPath) {
                console.log(key, keyPath);
            }


        },

        data() {
            return {
                activeIndex: 2,
                activeIndex2: 2,

                pageSize:5,
                currentPage:1,

                totalCount:100,

                // table_name: 1,

                rows:[],

                brand: {
                    status: '',
                    brandName: '',
                    companyName: '',
                    id:"",
                    ordered:"",
                    ordered2:"",
                    description:""
                },
            };
        }
    })
</script>



<script>



    new Vue({

        el: "#app",

        mounted(){

            // let that = this;
            // Utils.$on('demo', function () {
            //     // console.log(msg);
            //     that.selectALL(); //这里就是调用你的方法
            // })

            this.selectALL();

            // //无法在axios使用this，所以在axios外定义了一个
            // var _this = this;
            //
            // //页面加载完后发送异步请求，获取数据
            // axios({
            //     method:"get",
            //     url:"http://localhost:8081/brand-case/selectAllServlet"
            // }).then(function (response) {
            //     _this.tableData = response.data;
            // })
        },



        methods: {

            // tableChange(name){
            //     const _this = this;
            //     axios({
            //         method:"post",
            //         url:"http://localhost:8081/brand-case/tableChange",
            //         data:_this.brand
            //     }).then(function (resp) {
            //         if(resp.data == "success"){
            //             // 重新查询数据
            //             _this.selectALL();
            //             // 弹出消息提示
            //             _this.$message({
            //                 message: '切换成功',
            //                 type: 'success'
            //             });
            //         }
            //     })
            // },

            selectALL() {
                //无法在axios使用this，所以在axios外定义了一个
                var _this = this;
                num = 1;
                // console.log("aabb"+_this.brand.tablename);
                //页面加载完后发送异步请求，获取数据
                axios({
                    method:"post",
                    url:"http://localhost:8081/brand-case/selectByPageAndCondition?currentPage="+this.currentPage+"&pageSize="+this.pageSize,
                    data:_this.brand
                }).then(resp =>{
                    //设置表格数据
                    _this.tableData = resp.data.rows; // {rows:[],totalCount:100}
                    //设置总记录数
                    _this.totalCount = resp.data.totalCount;

                })
            },

            // selectALLSec() {
            //     //无法在axios使用this，所以在axios外定义了一个
            //     var _this = this;
            //     num = 2;
            //     //页面加载完后发送异步请求，获取数据
            //     axios({
            //         method:"get",
            //         url:"http://localhost:8081/brand-case/brand/selectAllSec",
            //         data:_this.brandSec
            //     }).then(resp =>{
            //         //设置表格数据
            //         _this.tableData = resp.data.rowsSec; // {rows:[],totalCount:100}
            //         //设置总记录数
            //         _this.totalCount = resp.data.totalCountSec;
            //     })
            // },

            tableRowClassName({row, rowIndex}) {
                if (rowIndex === 1) {
                    return 'warning-row';
                } else if (rowIndex === 3) {
                    return 'success-row';
                }
                return '';
            },

            // 复选框选中后执行的方法
            handleSelectionChange(val) {
                this.multipleSelection = val;
            },

            // 查询方法
            onSubmit() {
                this.selectALL();
            },

            // 添加数据
            addBrand(){
                //console.log(this.brand);
                //发送ajax请求，添加数据
                var _this = this;
                axios({
                    method: "post",
                    url:"http://localhost:8081/brand-case/addServlet",
                    data: _this.brandSec
                }).then(function (response) {
                    if (response.data == "success"){
                        _this.selectALL();
                        //关闭窗口
                        _this.dialogVisible = false;

                        _this.$message({
                            message:'添加成功!',
                            type:'success'
                        });
                    }else {
                        _this.$message.error('添加失败');
                    }
                })
            },

            updateById(index, row) {
                var _this = this;
                _this.brand.id = row.id;
                _this.addVisible = true;
            },
            //修改数据
            updatebrand(){
                var _this = this;
                //发送ajax异步请求，添加数据
                axios({
                    method: "post",
                    url: "http://localhost:8081/brand-case/updateServlet",
                    data: _this.brandThd
                }).then(function (resp) {
                    if (resp.data == "success") {
                        //关闭窗口
                        _this.addVisible = false;
                        //查询一次
                        _this.selectALL();
                        _this.$message({
                            message: '修改成功',
                            type: 'success'
                        });
                    } else {
                        _this.$message.error('修改数据失败');
                    }
                })
            },

            //删除数据
            deleteById(index, row) {
                var _this = this;
                this.$confirm('此操作将删除该数据, 是否继续?', '提示', {
                    confirmButtonText: '确定',
                    cancelButtonText: '取消',
                    type: 'warning'
                }).then(() => {
                    // 发送ajax请求，添加数据
                    axios({
                        method: "get",
                        url: "http://localhost:8081/brand-case/deleteServlet",
                        data: row.id
                    }).then(function (resp) {
                        if (resp.data == "success") {
                            // 重新查询数据
                            _this.selectALL();
                            // 弹出消息提示
                            _this.$message({
                                message: '删除成功',
                                type: 'success'
                            });
                        }
                    })
                }).catch(() => {
                    //用户点击取消按钮
                    this.$message({
                        type: 'info',
                        message: '已取消删除'
                    });
                });
            },


            //批量删除的方法
            deleteByIds(){
                //1.创建id数组
                for (let i = 0; i < this.multipleSelection.length; i++) {
                    let selectionElement = this.multipleSelection[i];
                    this.selectedIds[i] = selectionElement.id;
                }
                var _this = this;

                _this.$confirm('该操作不可逆，是否确定要删除已选择的数据?', '警告', {
                    confirmButtonText: '确定',
                    cancelButtonText: '取消',
                    type: 'warning'
                }).then(() => {
                    //确定

                    //发送ajax请求
                    axios({
                        method: "post",
                        url: "http://localhost:8081/brand-case/deleteByIdsServlet",
                        data: _this.selectedIds
                    }).then(function (resp) {
                        if (resp.data == "success") {
                            //关闭窗口
                            _this.addVisible = false;
                            //查询一次
                            _this.selectALL();
                            _this.$message({
                                message: '删除成功',
                                type: 'success'
                            });
                        } else {
                            _this.$message.error('删除失败');
                        }
                    });
                }).catch(() => {
                    //取消
                    _this.$message({
                        type: 'info',
                        message: '已取消删除'
                    });
                });

            },

            //分页
            handleSizeChange(val) {
                this.pageSize  = val;
                this.selectALL();
            },
            handleCurrentChange(val) {
                this.currentPage  = val;
                this.selectALL();
            },

            handleSelect(key, keyPath) {
                console.log(key, keyPath);
            }

        },

        handleOpen(key, keyPath) {
            console.log(key, keyPath);
        },
        handleClose(key, keyPath) {
            console.log(key, keyPath);
        },

        data() {
            return {
                cup:1,
                toc:1,

                activeIndex: '1',
                activeIndex2:'2',
                pageSize:5,

                totalCount:100,

                addVisible: false,
                // 当前页码
                currentPage: 1,

                // 添加数据对话框是否展示的标记
                dialogVisible: false,

                rows:[],
                rowsSec:[],

                // tablename:"tb_brand",

                // 品牌模型数据
                brand: {
                    status: '',
                    brandName: '',
                    companyName: '',
                    id:"",
                    ordered:"",
                    ordered2:"",
                    description:""
                },

                // 品牌模型数据
                brandSec: {
                    status: '',
                    brandName: '',
                    companyName: '',
                    id:"",
                    ordered:"",
                    ordered2:"",
                    description:""
                },

                // 品牌模型数据
                brandThd: {
                    status: '',
                    brandName: '',
                    companyName: '',
                    id:"",
                    ordered:"",
                    ordered2:"",
                    description:""
                },

                //批量删除中被选中的id数组
                selectedIds:[],
                // 复选框选中数据集合
                multipleSelection: [],
                // 表格数据
                tableData: [{
                    brandName: '华为',
                    companyName: '华为科技有限公司',
                    ordered: '100',
                    status: "1"
                }, {
                    brandName: '华为',
                    companyName: '华为科技有限公司',
                    ordered: '100',
                    status: "1"
                }, {
                    brandName: '华为',
                    companyName: '华为科技有限公司',
                    ordered: '100',
                    status: "1"
                }, {
                    brandName: '华为',
                    companyName: '华为科技有限公司',
                    ordered: '100',
                    status: "1"
                }]
            }
        }
    })

</script>

</body>
</html>